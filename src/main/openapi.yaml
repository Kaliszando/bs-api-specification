openapi: 3.0.3

info:
  title: bs-api-specification
  description: Bug Stalker - bug tracking system API specification
  version: 1.0.0
  termsOfService: http://swagger.io/terms/
  contact:
    email: kaliszadam99+bugstalker@gmail.com
  license:
    name: GPLv3
    url: https://www.gnu.org/licenses/gpl-3.0.html

externalDocs:
  description: Find out more about Swagger
  url: http://swagger.io

servers:
  - url: /api/v1
    description: default version of API endpoints

components:
  schemas:
    LoginCredentialsDto:
      $ref: './components/LoginCredentialsDto.yaml'

    UserInfoDto:
      $ref: './components/UserInfoDto.yaml'
    UserDetailsDto:
      allOf:
        - $ref: './components/BaseDetailsDto.yaml'
        - $ref: './components/UserInfoDto.yaml'
        - $ref: './components/UserExtendedDto.yaml'

    ProjectInfoDto:
      $ref: './components/ProjectInfoDto.yaml'

paths:
  /auth/sign-in:
    post:
      tags:
        - authEndpoint
      operationId: signIn
      description: User login endpoint
      requestBody:
        content:
          application/json:
            schema:
              $ref: './components/LoginCredentialsDto.yaml'
      responses:
        '204':
          description: Authorization attempt success, JWT token in header
        '401':
          description: Authorization attempt failed, invalid credentials

  /auth/ping:
    get:
      tags:
        - authEndpoint
      operationId: ping
      description: Service endpoint for test purposes
      responses:
        '204':
          description: Server works

  /context:
    get:
      tags:
        - contextEndpoint
      operationId: getAppContext
      description: Service returning essential app data
      responses:
        '200':
          description: App data returned succesfully
          content:
            application/json:
              schema:
                $ref: './components/UserInfoDto.yaml'

  /user:
    get:
      tags:
        - userEndpoint
      operationId: getUserByPhrase
      description: Finds user by given input phrase
      parameters:
        - name: query
          in: query
          schema:
            type: string
      responses:
        '200':
          description: User list returned successsfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: './components/UserInfoDto.yaml'

  /project:
    post:
      tags:
        - projectEndpoint
      operationId: createProject
      description: Creates project with current user as owner
      requestBody:
        content:
          application/json:
            schema:
              $ref: './components/ProjectInfoDto.yaml'
      responses:
        '201':
          description: Project created successfully
        '422':
          description: Save request is invalid

    get:
      tags:
        - projectEndpoint
      operationId: getProjects
      description: Returns list of available projects for current user
      responses:
        '200':
          description: Projects returned successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: './components/ProjectInfoDto.yaml'
